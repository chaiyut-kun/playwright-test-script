# ตารางกรณีทดสอบ (Playwright)

- ขอบเขต: ไฟล์ `*.spec.js` ทั้งหมดในโฟลเดอร์ `tests/`
- เงื่อนไขสภาพแวดล้อมก่อนทดสอบ:
  - เซิร์ฟเวอร์ API ที่ `http://localhost:3000` ทำงานและมีข้อมูลเริ่มต้น
  - มีตัวแปรสภาพแวดล้อม `UI_URL` สำหรับ URL ของ UI
  - มีชุดข้อมูลทดสอบใน `tests/users.js` สำหรับการทดสอบแบบพารามิเตอร์ (Parameterized)

## tests/api.spec.js — การทดสอบรวม API

| รหัสกรณีทดสอบ | ชื่อกรณีทดสอบ | ประเภท | เงื่อนไขก่อนทดสอบ | ข้อมูลทดสอบ | ขั้นตอน | ผลลัพธ์ที่คาดหวัง |
|---|---|---|---|---|---|---|
| API-001 | เรียกดูผู้ใช้ด้วยโทเค็น (Get Users with Auth Token) | API | เซิร์ฟเวอร์ API ทำงาน และมีผู้ใช้ที่ถูกต้อง | Email: `testuser@example.com`, Password: `password123` | 1) ส่งคำขอ POST ไปที่ `/api/login` พร้อมอีเมล/รหัสผ่าน 2) ดึงค่า `token` จากคำตอบ 3) เรียก GET `/api/users` โดยแนบ `Cookie: token=<token>` | เข้าสู่ระบบสำเร็จและได้โทเค็น GET `/api/users` ตอบกลับสถานะ 200 และ `users.data.length > 0` |

## tests/api-login.spec.js — เข้าสู่ระบบ API สำเร็จ

| รหัสกรณีทดสอบ | ชื่อกรณีทดสอบ | ประเภท | เงื่อนไขก่อนทดสอบ | ข้อมูลทดสอบ | ขั้นตอน | ผลลัพธ์ที่คาดหวัง |
|---|---|---|---|---|---|---|
| API-LOGIN-001 | เข้าสู่ระบบและรับโทเค็น | API | เซิร์ฟเวอร์ API ทำงาน และมีผู้ใช้อยู่แล้ว | Email: `test.627@mail.com`, Password: `test627` | 1) ส่งคำขอ POST ไปที่ `/api/login` พร้อมข้อมูลเข้าสู่ระบบ | สถานะ 200 เนื้อหามี `message` ที่มีคำว่า "Login Successfully!" และมี `token` ไม่ว่างเปล่า |

## tests/api-login-fail.spec.js — เข้าสู่ระบบ API ล้มเหลว

| รหัสกรณีทดสอบ | ชื่อกรณีทดสอบ | ประเภท | เงื่อนไขก่อนทดสอบ | ข้อมูลทดสอบ | ขั้นตอน | ผลลัพธ์ที่คาดหวัง |
|---|---|---|---|---|---|---|
| API-LOGIN-FAIL-001 | เข้าสู่ระบบด้วยผู้ใช้ที่ไม่ถูกต้องต้องล้มเหลว | API | เซิร์ฟเวอร์ API ทำงาน | ทดสอบแบบพารามิเตอร์จาก `tests/users.js` อาร์เรย์ `unknows`: 1) `email: test.628@mail.com`, `password: test628` 2) `email: meme@mail.com`, `password: meme` 3) `email: joke.cum`, `password: jo` | สำหรับแต่ละชุดข้อมูล: 1) ส่ง POST `/api/login` ด้วยอีเมล/รหัสผ่านตามชุดข้อมูล | สถานะ 404 ข้อความ `message` มีคำว่า "No account found for this user" และไม่ควรได้โทเค็นที่ใช้ได้ |

## tests/api-register.spec.js — ลงทะเบียน API สำเร็จ (เพื่อเตรียมอัปเดต)

| รหัสกรณีทดสอบ | ชื่อกรณีทดสอบ | ประเภท | เงื่อนไขก่อนทดสอบ | ข้อมูลทดสอบ | ขั้นตอน | ผลลัพธ์ที่คาดหวัง |
|---|---|---|---|---|---|---|
| API-REGISTER-001 | ลงทะเบียนผู้ใช้หลายรายเพื่อใช้อัปเดตภายหลัง | API | เซิร์ฟเวอร์ API ทำงาน | ทดสอบแบบพารามิเตอร์จาก `tests/users.js` อาร์เรย์ `userForUpdate1` (4 ผู้ใช้: username/email/password) | สำหรับผู้ใช้แต่ละราย: 1) ส่ง POST `/api/register` พร้อม `name`, `email`, `password` | สถานะ 201 ข้อความตอบกลับมีคำว่า "Register Successfully" |

## tests/api-register-fail.spec.js — ลงทะเบียน API ล้มเหลว (อีเมลซ้ำ)

| รหัสกรณีทดสอบ | ชื่อกรณีทดสอบ | ประเภท | เงื่อนไขก่อนทดสอบ | ข้อมูลทดสอบ | ขั้นตอน | ผลลัพธ์ที่คาดหวัง |
|---|---|---|---|---|---|---|
| API-REGISTER-FAIL-001 | ลงทะเบียนด้วยอีเมลที่มีอยู่แล้วต้องล้มเหลว | API | เซิร์ฟเวอร์ API ทำงาน และมีผู้ใช้ `testuser@example.com` อยู่แล้ว | name: `testuser`, email: `testuser@example.com`, password: `password123` | 1) ส่ง POST ไปที่ `/api/register` | สถานะ 409 ข้อความตอบกลับมีคำว่า "Email already exists!" |

## tests/api-update-success.spec.js — อัปเดตผู้ใช้ตามรหัส (สำเร็จ)

| รหัสกรณีทดสอบ | ชื่อกรณีทดสอบ | ประเภท | เงื่อนไขก่อนทดสอบ | ข้อมูลทดสอบ | ขั้นตอน | ผลลัพธ์ที่คาดหวัง |
|---|---|---|---|---|---|---|
| API-UPDATE-001 | อัปเดตข้อมูลผู้ใช้ด้วยรหัส (ID) | API | เซิร์ฟเวอร์ API ทำงาน และมีผู้ใช้ตามรหัส | ทดสอบแบบพารามิเตอร์จาก `tests/users.js` `userForUpdate2` (id + username/email/password จำนวน 4 ราย) | สำหรับผู้ใช้แต่ละราย: 1) ส่ง PUT `/api/users/{id}` พร้อม `name`, `email`, `password` ใหม่ | สถานะ 200 ข้อความตอบกลับมีคำว่า "Update user Successfully!" |

## tests/login-success.spec.js — เข้าสู่ระบบ UI สำเร็จ

| รหัสกรณีทดสอบ | ชื่อกรณีทดสอบ | ประเภท | เงื่อนไขก่อนทดสอบ | ข้อมูลทดสอบ | ขั้นตอน | ผลลัพธ์ที่คาดหวัง |
|---|---|---|---|---|---|---|
| UI-LOGIN-001 | เข้าสู่ระบบเพื่อเข้าใช้งานระบบ | UI | UI เปิดใช้งานที่ `UI_URL`; API เข้าถึงได้ | ทดสอบแบบพารามิเตอร์จาก `tests/users.js` `users`: 1) `test.627@mail.com`/`test627` 2) `unique1@mail.com`/`test` 3) `umami@mail.com`/`umami` | สำหรับผู้ใช้แต่ละราย: 1) ไปที่ `UI_URL` 2) คลิกปุ่ม `started` 3) กรอก `email` 4) กรอก `password` 5) คลิก `Login` | UI แสดงปุ่มที่มี `aria-label="client-response"` โดยมีข้อความที่มีคำว่า "Login Successfully!" บันทึกสกรีนช็อตที่ `screenshot/success/login-user{i}.png` |

## tests/login-fail.spec.js — เข้าสู่ระบบ UI ล้มเหลว

| รหัสกรณีทดสอบ | ชื่อกรณีทดสอบ | ประเภท | เงื่อนไขก่อนทดสอบ | ข้อมูลทดสอบ | ขั้นตอน | ผลลัพธ์ที่คาดหวัง |
|---|---|---|---|---|---|---|
| UI-LOGIN-FAIL-001 | เข้าสู่ระบบไม่ถูกต้องต้องแสดงข้อผิดพลาด | UI | UI เปิดใช้งานที่ `UI_URL`; API เข้าถึงได้ | ทดสอบแบบพารามิเตอร์จาก `tests/users.js` `unknows` (3 ผู้ใช้) | สำหรับแต่ละชุดข้อมูล: 1) ไปที่ `UI_URL` 2) คลิก `started` 3) กรอก `email` 4) กรอก `password` 5) คลิก `Login` | UI แสดงปุ่มที่มี `aria-label="client-response"` โดยมีข้อความที่มีคำว่า "No account found for this user" บันทึกสกรีนช็อตที่ `screenshot/fail/login-user{i}.png` |

## tests/register-success.spec.js — ลงทะเบียน UI สำเร็จ

| รหัสกรณีทดสอบ | ชื่อกรณีทดสอบ | ประเภท | เงื่อนไขก่อนทดสอบ | ข้อมูลทดสอบ | ขั้นตอน | ผลลัพธ์ที่คาดหวัง |
|---|---|---|---|---|---|---|
| UI-REGISTER-001 | ลงทะเบียนผู้ใช้ใหม่สำเร็จ | UI | UI เปิดใช้งานที่ `UI_URL`; API เข้าถึงได้ | ทดสอบแบบพารามิเตอร์จาก `tests/users.js` `newUsers` (3 ผู้ใช้) | สำหรับผู้ใช้แต่ละราย: 1) ไปที่ `UI_URL` 2) คลิก `started` 3) คลิก `Register` 4) กรอก `username` 5) กรอก `email` 6) กรอก `password` 7) คลิก `Register` | UI แสดงปุ่มที่มี `aria-label="client-response"` โดยมีข้อความที่มีคำว่า "Register Successfully!" บันทึกสกรีนช็อตที่ `screenshot/success/register-user{i}.png` |

## tests/register-fail.spec.js — ลงทะเบียน UI ล้มเหลว (ข้อมูลซ้ำ)

| รหัสกรณีทดสอบ | ชื่อกรณีทดสอบ | ประเภท | เงื่อนไขก่อนทดสอบ | ข้อมูลทดสอบ | ขั้นตอน | ผลลัพธ์ที่คาดหวัง |
|---|---|---|---|---|---|---|
| UI-REGISTER-FAIL-001 | ลงทะเบียนซ้ำต้องแสดงข้อผิดพลาด | UI | UI เปิดใช้งานที่ `UI_URL`; API เข้าถึงได้; มีข้อมูลผู้ใช้ทดสอบอยู่แล้ว | ทดสอบแบบพารามิเตอร์จาก `tests/users.js` `newFailUsers` (3 ผู้ใช้ ที่ซ้ำ) | สำหรับผู้ใช้แต่ละราย: 1) ไปที่ `UI_URL` 2) คลิก `started` 3) คลิก `Register` 4) กรอก `username`, `email`, `password` 5) คลิก `Register` | UI แสดงปุ่มที่มี `aria-label="client-response"` โดยมีข้อความที่มีคำว่า "Email already exists!" บันทึกสกรีนช็อตที่ `screenshot/fail/register-user{i}.png` |

---

บันทึกเพิ่มเติม
- แหล่งข้อมูล: `tests/users.js` ให้ชุดข้อมูลสำหรับกรณีสำเร็จ/ล้มเหลว และการอัปเดต
- มีการตรวจสอบรหัสสถานะ (status code) และข้อความตอบกลับในสเปกของ API โดยตรง
- การตรวจสอบฝั่ง UI อ้างอิงคอมโพเนนต์ที่มี `aria-label="client-response"` เพื่ออ่านผลลัพธ์ที่แสดง
